'use strict';window.tsfPTGB=function(a){const b="undefined"!=typeof tsfPTL10n&&tsfPTL10n,c=b?.taxonomies,{createElement:d,Fragment:e,Component:f,useState:g,useEffect:h}=wp.element,{SelectControl:i}=wp.components,{useSelect:j}=wp.data,{unescape:k}=lodash,l=[],m={per_page:-1,orderby:"id",order:"asc",_fields:"id,name"},n=(a,b)=>c[a].i18n[b]||"";let o={};const p=b=>{const d=()=>document.getElementById(`autodescription[_primary_term_${b}]`),e=()=>+d().value,f=a=>+(d().value=+a);return{get:e,set:f,revalidate:a=>{let b=e();return a.includes(b)?b:f(a?.[0]||0)},register:()=>{let d=document.getElementById("tsf-gutenberg-data-holder");if(!d)return o[b]=!1;let e=wp.template("tsf-primary-term-selector")({taxonomy:c[b]});return o[b]=!!a(e).appendTo(d)},isRegistered:()=>o[b]||!1}},q=()=>{function a({taxonomySlug:a,_legacySelectedTerms:b}){const c=p(a),[e,f]=g(c.get()),[o,q]=g(!1),[r,s]=g(!1),{selectedTerms:t,loading:u,availableTerms:v,_taxonomy:w}=j(b=>{const{getTaxonomy:c,getEntityRecords:d,isResolving:e}=b("core"),{getEditedPostAttribute:f}=b("core/editor"),g=c(a),h=["taxonomy",a,m];return{selectedTerms:f(g?.rest_base)||l,loading:r||e("getEntityRecords",h),availableTerms:o||d(...h)||l,_taxonomy:g}},[a,r,o]);if(h(()=>{t.includes(+e)&&c.get()===+e||(c.revalidate(t),f(c.get()))},[t]),h(()=>(w?.rest_base&&b?.length&&!r&&(!o?.length||b.filter(a=>!v.map(a=>a.id).includes(a)).length)&&(s(!0),wp.apiFetch({path:wp.url?.addQueryArgs(`/wp/v2/${w.rest_base}`,m)}).then(a=>{q(a)}).finally(()=>{s(!1)})),()=>{s(!1)}),[b]),2>t?.length)return c.set(0),null;const x=a=>{t.includes(+a)&&(c.set(a),f(c.get()),"tsfAys"in window&&tsfAys.registerChange())};return d(i,{label:n(a,"selectPrimary"),value:e,className:"tsf-pt-gb-selector",onChange:x,options:(()=>v.map(a=>t.includes(a?.id)&&{value:a.id,label:k(a?.name)}).filter(Boolean)||"")(),disabled:(()=>!(t.length&&v.length&&!u))()})}if(Object.keys(c).length){for(let a in c)p(a).register();wp.hooks.addFilter("editor.PostTaxonomyType","tsf/pt",b=>class extends f{render(){return p(this.props?.slug).isRegistered()?d(e,null,d(b,{...this.props}),d(a,{taxonomySlug:this.props?.slug,_legacySelectedTerms:this.props?.terms})):d(b,{...this.props})}})}};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",q)}},{},{l10n:b})}(jQuery),window.tsfPTGB.load();
