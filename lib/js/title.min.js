'use strict';window.tsfTitle=function(a){const b="undefined"!=typeof tsfTitleL10n&&tsfTitleL10n,c=tsf.escapeString(b.params.untitledTitle),d=tsf.escapeString(b.i18n.protectedTitle),e=tsf.escapeString(b.i18n.privateTitle),f=!!b.params.stripTitleTags,g=new Map,h={},i=new Map,j=new Map,k=a=>i.get(a)||"",l=a=>j.get(a)||"",m=(a,b)=>i.set(a,b)&&k(a),n=(a,b)=>j.set(a,b)&&l(a),o=a=>document.getElementById(`tsf-title-placeholder-prefix_${a}`)||document.createElement("span"),p=a=>document.getElementById(`tsf-title-placeholder-additions_${a}`)||document.createElement("span"),q=a=>g.get(a),r=(a,b)=>b?h[a]?.[b]:h[a],s=(a,b,c)=>{if(h[a][b]!==c)switch(h[a][b]=c,b){case"showPrefix":case"prefixValue":case"prefixPlacement":x(a),H(a);break;case"addAdditions":case"separator":case"additionValue":case"additionPlacement":w(a),H(a);break;case"allowReferenceChange":case"defaultTitle":default:H(a);}},t=a=>{let b=[document.getElementById(`tsf-title-reference_${a}`)];if(r(a,"hasLegacy")){let a=document.getElementById("tsf-title-reference");a&&b.unshift(a)}return b},u=a=>[document.getElementById(`tsf-title-noadditions-reference_${a}`)],v=a=>{const b=t(a.target.id),c=u(a.target.id);if(!b[0]||!c[0])return;const d=r(a.target.id,"allowReferenceChange");let e=d&&a.target.value.trim()||r(a.target.id,"defaultTitle")||"",f=e;if(e.length&&d){let b=l(a.target.id),c=k(a.target.id);if(b.length&&r(a.target.id,"showPrefix")){switch(r(a.target.id,"prefixPlacement")){case"before":tsf.l10n.states.isRTL?e+=b:e=b+e;break;case"after":tsf.l10n.states.isRTL?e=b+e:e+=b;}f=e}if(c.length)switch(r(a.target.id,"additionPlacement")){case"before":e=c+e;break;case"after":e+=c;}}const g=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(tsf.sTabs(tsf.sSingleLine(e).trim())))),h=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(tsf.sTabs(tsf.sSingleLine(f).trim())))),i=new Event("change");b.forEach(a=>{a.innerHTML=g,setTimeout(()=>{a.dispatchEvent(i)},0)}),c.forEach(a=>{a.innerHTML=h,setTimeout(()=>{a.dispatchEvent(i)},0)})},w=a=>{let b="",c="",d="";if(r(a,"addAdditions")&&(c=tsf.escapeString(tsf.decodeEntities(r(a,"additionValue"))),d=r(a,"separator")),c)switch(r(a,"additionPlacement")){case"before":b=`${c} ${d} `;break;case"after":b=` ${d} ${c}`;}p(a).innerHTML=m(a,b||"")},x=a=>{let b="",c=r(a,"showPrefix"),d=r(a,"prefixValue");if(c&&d)switch(r(a,"prefixPlacement")){case"before":b=tsf.l10n.states.isRTL?` ${d}`:`${d} `;break;case"after":b=tsf.l10n.states.isRTL?`${d} `:` ${d}`;}o(a).innerHTML=n(a,b||"")},y=a=>{let b=p(a.target.id),c=o(a.target.id);if(!b&&!c)return;const d=a.target,e=a.target.value,f=l(a.target.id).length&&r(a.target.id,"showPrefix"),g=!!k(a.target.id).length;if(!f&&c&&(c.style.display="none"),!g&&b&&(b.style.display="none"),!f&&!g)return void(d.style.textIndent="initial");if(!e.length)return d.style.textIndent="initial",c&&(c.style.display="none"),void(b&&(b.style.display="none"));const h=getComputedStyle(d),i=d.getBoundingClientRect(),j=parseInt(h.paddingTop),m=parseInt(h.paddingRight),n=parseInt(h.paddingBottom),q=parseInt(h.paddingLeft),s=parseInt(h.borderTopWidth),t=parseInt(h.borderRightWidth),u=parseInt(h.borderBottomWidth),v=parseInt(h.borderTopWidth),w=parseInt(h.marginTop),x=parseInt(h.marginRight),y=parseInt(h.marginBottom),z=parseInt(h.marginLeft),A=tsf.l10n.states.isRTL?"right":"left",B=q+v+z;let C={display:h.display,lineHeight:h.lineHeight,fontFamily:h.fontFamily,fontWeight:h.fontWeight,fontSize:h.fontSize,letterSpacing:h.letterSpacing,marginTop:`${w}px`,marginBottom:`${y}px`,paddingTop:`${j}px`,paddingBottom:`${n}px`,border:`0 solid transparent`,borderTopWidth:`${s}px`,borderBottomWidth:`${u}px`},D=0,E=0,F=0,G=0,H=0;if(f&&(Object.assign(c.style,C,{maxWidth:"initial"}),H=c.getBoundingClientRect().width,F+=B),g){Object.assign(b.style,C,{maxWidth:"initial"});const c=document.getElementById(`tsf-title-offset_${a.target.id}`);c.textContent=e,Object.assign(c.style,{fontFamily:C.fontFamily,fontWeight:C.fontWeight,fontSize:C.fontSize,letterSpacing:C.letterSpacing});const d=c.getBoundingClientRect().width,f=b.getBoundingClientRect().width;switch(r(a.target.id,"additionPlacement")){case"before":D=i.width-(m+t+x)-q-v-d-H,0>D&&(H+=D,D=0),D=D<f?D:f,0>D&&(D=0),G+=D,F+=D,E+=B;break;case"after":D=i.width-B-m-t-d-H,0>D&&(H+=D,D=0),D=D<f?D:f,0>D&&(D=0),E+=B+d+H;}}H=0>H?0:H,f&&(Object.assign(c.style,{[A]:`${F}px`,maxWidth:`${H}px`}),G+=H),g&&Object.assign(b.style,{[A]:`${E}px`,maxWidth:`${D}px`}),d.style.textIndent=`${G}px`},z=a=>{a.target.placeholder=t(a.target.id)[0].textContent},A=a=>{if("tsfC"in window){let b=document.getElementById(`${a.target.id}_chars`),c=t(a.target.id)[0];b&&tsfC.updateCharacterCounter({e:b,text:c.innerHTML,field:"title",type:"search"})}},B=a=>{if("tsfC"in window){let b=document.getElementById(`${a.target.id}_pixels`),c=t(a.target.id)[0];b&&tsfC.updatePixelCounter({e:b,text:c.innerHTML,field:"title",type:"search"})}},C=a=>{if(a){let b=q(a);b&&b.dispatchEvent(new Event("input"))}else g.forEach(a=>a.id&&C(a.id))},D=a=>{if(a){let b=q(a);b&&b.dispatchEvent(new CustomEvent("tsf-update-title-counter"))}else g.forEach(a=>a.id&&D(a.id))},E=a=>{y(a),v(a),z(a),F(a)},F=a=>{A(a),B(a)};let G={};const H=a=>{a in G&&clearTimeout(G[a]),G[a]=setTimeout(()=>C(a),1e3/60)},I=a=>{if("tsfAys"in window){let b=tsfAys.areSettingsChanged();C(a),!b&&tsfAys.areSettingsChanged()&&tsfAys.reset()}else C(a)};let J={};const K=a=>{a in J&&clearTimeout(J[a]),J[a]=setTimeout(()=>I(a),1e3/60)},L=a=>{let b=document.getElementById(a.target.dataset.for);if(b){let c=a.target.classList.contains("tsf-title-placeholder-additions")?"additions":"prefix",d=b.value;switch(b.focus(),a.detail){case 3:b.setSelectionRange(0,d.length);break;case 2:let e,f;"additions"===c&&"after"===r(b.id,"additionPlacement")||"prefix"===c&&tsf.l10n.states.isRTL?(e=d.replace(/(\w+|\s+)$/u,"").length,f=d.length):(e=0,f=d.length-d.replace(/^(\s+|\w+)/u,"").length),b.setSelectionRange(e,f);break;case 1:default:let g="additions"===c&&"after"===r(b.id,"additionPlacement")?d.length:0;b.setSelectionRange(g,g);}}},M=a=>a.preventDefault();let N=window.innerWidth;const O=()=>{let a=window.innerWidth;N<a?782>=N&&782<=a&&I():782<=N&&782>=a&&I(),N=a},P=()=>{a(document).on("wp-window-resized",O),window.addEventListener("tsf-counter-updated",()=>K())},Q=a=>{if(!(!a instanceof Element)){a.addEventListener("input",E),a.addEventListener("tsf-update-title-counter",F);let b=o(a.id),c=p(a.id);b.addEventListener("click",L),c.addEventListener("click",L),b.addEventListener("mousedown",M),c.addEventListener("mousedown",M),w(a.id),x(a.id),K(a.id)}};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",P)}},{setInputElement:a=>(g.set(a.id,a),h[a.id]={showPrefix:!0,allowReferenceChange:!0,defaultTitle:"",separator:b.states.titleSeparator,prefixPlacement:b.states.prefixPlacement},Q(a),q(a.id)),getInputElement:q,getStateOf:r,updateStateOf:s,updateStateAll:(a,b,c)=>{c=Array.isArray(c)?c:[c],g.forEach(d=>{c.includes(d.id)||s(d.id,a,b)})},triggerCounter:D,triggerInput:C,enqueueTriggerInput:H,triggerUnregisteredInput:I,enqueueUnregisteredInputTrigger:K},{l10n:b,untitledTitle:c,privatePrefix:e,protectedPrefix:d,stripTitleTags:f})}(jQuery),window.tsfTitle.load();
